<!DOCTYPE html>
<html>

<head>
   <meta charset="utf-8">
   <script src="https://cdn.staticfile.org/angular.js/1.4.6/angular.min.js"></script>
   <title>dependency-injection</title>
   <!-- https://www.runoob.com/angularjs/angularjs-dependency-injection.html -->
   <!-- 
    AngularJS 依赖注入
    什么是依赖注入
    wiki 上的解释是：依赖注入（Dependency Injection，简称DI）是一种软件设计模式，在这种模式下，一个或更多的依赖（或服务）被注入（或者通过引用传递）到一个独立的对象（或客户端）中，然后成为了该客户端状态的一部分。

    该模式分离了客户端依赖本身行为的创建，这使得程序设计变得松耦合，并遵循了依赖反转和单一职责原则。与服务定位器模式形成直接对比的是，它允许客户端了解客户端如何使用该系统找到依赖

    一句话 --- 没事你不要来找我，有事我会去找你。

    AngularJS 提供很好的依赖注入机制。以下5个核心组件用来作为依赖注入：

    value
    factory
    service
    provider
    constant

 -->
   <!-- 
   AngularJS 实例 - provider
 -->
</head>

<body>
   <h2>AngularJS 简单应用</h2>

   <div ng-app="mainApp" ng-controller="CalcController">
      <p>输入一个数字: <input type="number" ng-model="number" /></p>
      <button ng-click="square()">X<sup>2</sup></button>
      <p>结果: {{result}}</p>
   </div>

   <script>
      var mainApp = angular.module("mainApp", []);

      mainApp.config(function ($provide) {
         $provide.provider('MathService', function () {
            this.$get = function () {
               var factory = {};

               factory.multiply = function (a, b) {
                  return a * b;
               }
               return factory;
            };
         });
      });

      mainApp.value("defaultInput", 5);

      mainApp.service('CalcService', function (MathService) {
         this.square = function (a) {
            return MathService.multiply(a, a);
         }
      });

      mainApp.controller('CalcController', function ($scope, CalcService, defaultInput) {
         $scope.number = defaultInput;
         $scope.result = CalcService.square($scope.number);

         $scope.square = function () {
            $scope.result = CalcService.square($scope.number);
         }
      });

   </script>

</body>

</html>